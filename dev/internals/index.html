<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Internals · SeqFold.jl</title><meta name="title" content="Internals · SeqFold.jl"/><meta property="og:title" content="Internals · SeqFold.jl"/><meta property="twitter:title" content="Internals · SeqFold.jl"/><meta name="description" content="Documentation for SeqFold.jl."/><meta property="og:description" content="Documentation for SeqFold.jl."/><meta property="twitter:description" content="Documentation for SeqFold.jl."/><meta property="og:url" content="https://phlaster.github.io/SeqFold.jl/internals/"/><meta property="twitter:url" content="https://phlaster.github.io/SeqFold.jl/internals/"/><link rel="canonical" href="https://phlaster.github.io/SeqFold.jl/internals/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">SeqFold.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Exported Functions</a></li><li class="is-active"><a class="tocitem" href>Internals</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Internals</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Internals</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/phlaster/SeqFold.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/phlaster/SeqFold.jl/blob/master/docs/src/internals.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="API"><a class="docs-heading-anchor" href="#API">API</a><a id="API-1"></a><a class="docs-heading-anchor-permalink" href="#API" title="Permalink"></a></h1><p>Documentation for <a href="https://github.com/phlaster/SeqFold.jl">SeqFold</a>.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SeqFold._v!" href="#SeqFold._v!"><code>SeqFold._v!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Find, store and return the minimum free energy of the structure between i and j. If i and j don&#39;t base pair, store and return INF. See: Figure 2B of Zuker, 1981</p><p>Args:     seq: The sequence being folded (uppercase).     i: The start index.     j: The end index (1-based, inclusive).     temp: The temperature in Kelvin.     v<em>cache: Free energy cache for if i and j base pair. Stores <code>Structure</code>.     w</em>cache: Free energy cache for lowest energy structure from i to j. Stores <code>Structure</code>.     emap: Energy map for DNA/RNA (<code>Energies</code> struct).</p><p>Returns:     Structure: The minimum free energy structure possible between i and j.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/phlaster/SeqFold.jl/blob/469c9ece6f6d2d9a1e8c4ae69d5dd19c9b9ffdd8/src/fold.jl#L262-L278">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SeqFold._d_g" href="#SeqFold._d_g"><code>SeqFold._d_g</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Find the free energy given delta h, s and temp</p><p>Args:     <code>d_h</code>: The enthalpy increment in kcal / mol     <code>d_s</code>: The entropy increment in cal / mol     <code>temp_K</code>: The temperature in Kelvin</p><p>Returns:     The free energy increment in kcal / (mol x K)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/phlaster/SeqFold.jl/blob/469c9ece6f6d2d9a1e8c4ae69d5dd19c9b9ffdd8/src/fold.jl#L434-L444">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SeqFold.DNA_HAIRPIN_LOOPS" href="#SeqFold.DNA_HAIRPIN_LOOPS"><code>SeqFold.DNA_HAIRPIN_LOOPS</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Enthalpy and entropy increments for length depedence of hairpin loops</p><p>Were calculated from delta G Table 4 of SantaLucia, 2004:</p><p>Annu.Rev.Biophs.Biomol.Struct.33:415-40 doi: 10.1146/annurev.biophys.32.110601.141800 The Thermodynamics of DNA Structural Motifs SantaLucia and Hicks, 2004</p><p>For hairpins of length 3 and 4, the entropy values are looked up in the DNA<em>TRI</em>TETRA_LOOPS Dict</p><p>From formula 8-9 of the paper: An additional 1.6 delta entropy penalty if the hairpin is closed by AT</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/phlaster/SeqFold.jl/blob/469c9ece6f6d2d9a1e8c4ae69d5dd19c9b9ffdd8/src/dna.jl#L461-L476">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SeqFold._multi_branch" href="#SeqFold._multi_branch"><code>SeqFold._multi_branch</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Calculate a multi-branch energy penalty using a linear formula.</p><p>From Jaeger, Turner, and Zuker, 1989. Found to be better than logarithmic in Ward, et al. 2017.</p><p>Args:     seq: The sequence being folded (uppercase).     i: The left starting index.     k: The mid-point in the search.     j: The right ending index.     temp: Folding temp in Kelvin.     v<em>cache: Cache of energies where V(i,j) bond. Stores <code>Structure</code>.     w</em>cache: Cache of min energy of substructures between W(i,j). Stores <code>Structure</code>.     emap: Map to DNA/RNA energies (<code>Energies</code> struct).     helix: Whether this multibranch is enclosed by a helix (V(i,j) forms a base pair).</p><p>Returns:     Structure: A multi-branch structure.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/phlaster/SeqFold.jl/blob/469c9ece6f6d2d9a1e8c4ae69d5dd19c9b9ffdd8/src/fold.jl#L727-L746">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SeqFold.DNA_TRI_TETRA_LOOPS" href="#SeqFold.DNA_TRI_TETRA_LOOPS"><code>SeqFold.DNA_TRI_TETRA_LOOPS</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Experimental delta H and delta S for tri/tetra loops:</p><ul><li>Supplemental Material: Annu.Rev.Biophs.Biomol.Struct.33:415-40</li></ul><p>doi: 10.1146/annurev.biophys.32.110601.141800 The Thermodynamics of DNA Structural Motifs SantaLucia and Hicks, 2004</p><ul><li>delta S was computed using delta G and delta H and is in cal / (K x mol)</li></ul><p>(versus delta H in kcal / mol)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/phlaster/SeqFold.jl/blob/469c9ece6f6d2d9a1e8c4ae69d5dd19c9b9ffdd8/src/dna.jl#L220-L229">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SeqFold._stack" href="#SeqFold._stack"><code>SeqFold._stack</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Get the free energy for a stack. Using the indexes i and j, check whether it&#39;s at the end of the sequence or internal. Then check whether it&#39;s a match or mismatch, and return. Two edge-cases are terminal mismatches and dangling ends. The energy of a dangling end is added to the energy of a pair where i XOR j is at the sequence&#39;s end.</p><p>Args:     seq: The full folding sequence (uppercase).     i: The start index on left side of the pair/stack.     i1: The index to the right of i.     j: The end index on right side of the pair/stack.     j1: The index to the left of j.     temp: Temperature in Kelvin.     emap: Energy map for DNA/RNA (<code>Energies</code> struct).</p><p>Returns:     Float64: The free energy of the NN pairing.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/phlaster/SeqFold.jl/blob/469c9ece6f6d2d9a1e8c4ae69d5dd19c9b9ffdd8/src/fold.jl#L468-L488">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SeqFold._pair" href="#SeqFold._pair"><code>SeqFold._pair</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Return a stack representation, a key for the NN maps</p><p>Args:     s: Sequence being folded     i: leftmost index     i1: index to right of i     j: rightmost index     j1: index to left of j</p><p>Returns:     string representation of the pair</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/phlaster/SeqFold.jl/blob/469c9ece6f6d2d9a1e8c4ae69d5dd19c9b9ffdd8/src/fold.jl#L399-L411">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SeqFold.DNA_INTERNAL_LOOPS" href="#SeqFold.DNA_INTERNAL_LOOPS"><code>SeqFold.DNA_INTERNAL_LOOPS</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Enthalpy and entropy increments for length dependence of internal loops</p><p>Were calculated from delta G Table 4 of SantaLucia, 2004:</p><p>Annu.Rev.Biophs.Biomol.Struct.33:415-40 doi: 10.1146/annurev.biophys.32.110601.141800 The Thermodynamics of DNA Structural Motifs SantaLucia and Hicks, 2004</p><p>Additional loop sizes are accounted for with the Jacobson-Stockmayer entry extrapolation formula in paper: delta G (loop-n) = delta G (loop-x) + 2.44 x R x 310.15 x ln(n / x)</p><p>Additional correction is applied for asymmetric loops in paper: delta G (asymmetry) = |length A - length B| x 0.3 (kcal / mol) where A and B are lengths of both sides of loop</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/phlaster/SeqFold.jl/blob/469c9ece6f6d2d9a1e8c4ae69d5dd19c9b9ffdd8/src/dna.jl#L364-L381">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SeqFold.DNA_INTERNAL_MM" href="#SeqFold.DNA_INTERNAL_MM"><code>SeqFold.DNA_INTERNAL_MM</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Internal mismatch table (DNA):</p><ul><li>Allawi &amp; SantaLucia (1997), Biochemistry 36: 10581-10594</li><li>Allawi &amp; SantaLucia (1998), Biochemistry 37: 9435-9444</li><li>Allawi &amp; SantaLucia (1998), Biochemistry 37: 2170-2179 * </li><li>Allawi &amp; SantaLucia (1998), Nucl Acids Res 26: 2694-2701 *</li><li>Peyret et al. (1999), Biochemistry 38: 3468-3477 *</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/phlaster/SeqFold.jl/blob/469c9ece6f6d2d9a1e8c4ae69d5dd19c9b9ffdd8/src/dna.jl#L34-L41">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SeqFold.DNA_TERMINAL_MM" href="#SeqFold.DNA_TERMINAL_MM"><code>SeqFold.DNA_TERMINAL_MM</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Terminal mismatch table (DNA):</p><ul><li>SantaLucia &amp; Peyret (2001) Patent Application WO 01/94611</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/phlaster/SeqFold.jl/blob/469c9ece6f6d2d9a1e8c4ae69d5dd19c9b9ffdd8/src/dna.jl#L96-L99">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SeqFold.DNA_NN" href="#SeqFold.DNA_NN"><code>SeqFold.DNA_NN</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>The Thermodynamics of DNA Structural Motifs</p><ul><li>SantaLucia and Hicks, 2004</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/phlaster/SeqFold.jl/blob/469c9ece6f6d2d9a1e8c4ae69d5dd19c9b9ffdd8/src/dna.jl#L13-L16">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SeqFold._hairpin" href="#SeqFold._hairpin"><code>SeqFold._hairpin</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Calculate the free energy of a hairpin.</p><p>Args:     seq: The sequence we&#39;re folding (uppercase).     i: The index of the start of hairpin.     j: The index of the end of hairpin (1-based, inclusive).     temp: Temperature in Kelvin.     emap: Energy map for DNA/RNA (<code>Energies</code> struct).</p><p>Returns:     Float64: The free energy increment from the hairpin structure.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/phlaster/SeqFold.jl/blob/469c9ece6f6d2d9a1e8c4ae69d5dd19c9b9ffdd8/src/fold.jl#L537-L549">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SeqFold._w!" href="#SeqFold._w!"><code>SeqFold._w!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Find and return the lowest free energy structure in Sij subsequence (1-based indices). This function calculates and stores results in <code>w_cache</code> to avoid recomputation. Figure 2B in Zuker and Stiegler, 1981.</p><p>Args:     seq: The sequence being folded.     i: The start index.     j: The end index (1-based, inclusive).     temp: The temperature in Kelvin.     v<em>cache: Free energy cache for if i and j base pair. Stores <code>Structure</code>.     w</em>cache: Free energy cache for lowest energy structure from i to j. Stores <code>Structure</code>.     emap: Energy map for DNA/RNA (<code>Energies</code> struct).</p><p>Returns:     Structure: The minimum free energy structure for the subsequence from i to j.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/phlaster/SeqFold.jl/blob/469c9ece6f6d2d9a1e8c4ae69d5dd19c9b9ffdd8/src/fold.jl#L216-L232">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SeqFold.DNA_MULTIBRANCH" href="#SeqFold.DNA_MULTIBRANCH"><code>SeqFold.DNA_MULTIBRANCH</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>a, b, c, d in a linear multi-branch energy change function.</p><p>Inferred from: Supplemental Material: Annu.Rev.Biophs.Biomol.Struct.33:415-40 doi: 10.1146/annurev.biophys.32.110601.141800 The Thermodynamics of DNA Structural Motifs SantaLucia and Hicks, 2004</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/phlaster/SeqFold.jl/blob/469c9ece6f6d2d9a1e8c4ae69d5dd19c9b9ffdd8/src/dna.jl#L3-L11">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SeqFold._internal_loop" href="#SeqFold._internal_loop"><code>SeqFold._internal_loop</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Calculate the free energy of an internal loop.</p><p>The first and last bp of both left and right sequences are not themselves parts of the loop, but are the terminal bp on either side of it. They are needed for when there&#39;s a single internal looping bp (where just the mismatching free energies are used).</p><p>Note that both left and right sequences are in 5&#39; to 3&#39; direction.</p><p>This is adapted from the &quot;Internal Loops&quot; section of SantaLucia/Hicks, 2004.</p><p>Args:     seq: The sequence we&#39;re folding (uppercase).     i: The index of the start of structure on left side.     i1: The index to the right of i.     j: The index of the end of structure on right side.     j1: The index to the left of j.     temp: Temperature in Kelvin.     emap: Dictionary mapping to energies for DNA/RNA (<code>Energies</code> struct).</p><p>Returns:     Float64: The free energy associated with the internal loop.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/phlaster/SeqFold.jl/blob/469c9ece6f6d2d9a1e8c4ae69d5dd19c9b9ffdd8/src/fold.jl#L650-L674">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SeqFold._j_s" href="#SeqFold._j_s"><code>SeqFold._j_s</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Estimate the free energy of length <code>query_len</code> based on one of length <code>known_len</code>.</p><p>The Jacobson-Stockmayer entry extrapolation formula is used for bulges, hairpins, etc that fall outside the 30nt upper limit for pre-calculated free-energies. See SantaLucia and Hicks (2004).</p><p>Args:     query<em>len: Length of element without known free energy value     known</em>len: Length of element with known free energy value (d<em>g</em>x)     d<em>g</em>x: The free energy of the element known<em>len     temp</em>K: Temperature in Kelvin</p><p>Returns:     Free energy for a structure of length <code>query_len</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/phlaster/SeqFold.jl/blob/469c9ece6f6d2d9a1e8c4ae69d5dd19c9b9ffdd8/src/fold.jl#L448-L463">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SeqFold._trackback_energy" href="#SeqFold._trackback_energy"><code>SeqFold._trackback_energy</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Add energy to each structure, based on how it&#39;s W(i,j) differs from the one after.</p><p>Args:     structs: The structures for whom energy is being calculated.</p><p>Returns:     Vector{Structure}: Structures in the folded DNA with energy.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/phlaster/SeqFold.jl/blob/469c9ece6f6d2d9a1e8c4ae69d5dd19c9b9ffdd8/src/fold.jl#L938-L946">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SeqFold._bulge" href="#SeqFold._bulge"><code>SeqFold._bulge</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Calculate the free energy associated with a bulge.</p><p>Args:     seq: The full folding DNA/RNA sequence (uppercase).     i: The start index of the bulge.     i1: The index to the right of i.     j: The end index of the bulge.     j1: The index to the left of j.     temp: Temperature in Kelvin.     emap: Map to DNA/RNA energies (<code>Energies</code> struct).</p><p>Returns:     Float64: The increment in free energy from the bulge.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/phlaster/SeqFold.jl/blob/469c9ece6f6d2d9a1e8c4ae69d5dd19c9b9ffdd8/src/fold.jl#L601-L615">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SeqFold.DNA_DE" href="#SeqFold.DNA_DE"><code>SeqFold.DNA_DE</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>DNA dangling ends:</p><ul><li>Bommarito et al. (2000), Nucl Acids Res 28: 1929-1934</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/phlaster/SeqFold.jl/blob/469c9ece6f6d2d9a1e8c4ae69d5dd19c9b9ffdd8/src/dna.jl#L151-L154">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SeqFold.DNA_BULGE_LOOPS" href="#SeqFold.DNA_BULGE_LOOPS"><code>SeqFold.DNA_BULGE_LOOPS</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Enthalpy and entropy increments for length depedence of bulge loops</p><p>Were calculated from delta G Table 4 of SantaLucia, 2004:</p><p>Annu.Rev.Biophs.Biomol.Struct.33:415-40 doi: 10.1146/annurev.biophys.32.110601.141800 The Thermodynamics of DNA Structural Motifs SantaLucia and Hicks, 2004</p><p>For bulge loops of size 1, the intervening NN energy is used. Closing AT penalty is applied on both sides</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/phlaster/SeqFold.jl/blob/469c9ece6f6d2d9a1e8c4ae69d5dd19c9b9ffdd8/src/dna.jl#L415-L427">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SeqFold._min_struct" href="#SeqFold._min_struct"><code>SeqFold._min_struct</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Return the struct with the lowest free energy that isn&#39;t -inf (undef)</p><p>Args:     structs: Structures being compared</p><p>Returns:     struct: The min free energy structure</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/phlaster/SeqFold.jl/blob/469c9ece6f6d2d9a1e8c4ae69d5dd19c9b9ffdd8/src/fold.jl#L416-L424">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SeqFold.dg_cache" href="#SeqFold.dg_cache"><code>SeqFold.dg_cache</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Fold a nucleic acid sequence and return the estimated ΔG of each (i,j) pairing.</p><p>Args:     seq: The nucleic acid sequence to fold</p><p>Keyword Args:     temp: The temperature to fold at</p><p>Returns:     Cache: A Vector{Vector} where each [i][j] pairing corresponds to the         minimum free energy between i and j</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/phlaster/SeqFold.jl/blob/469c9ece6f6d2d9a1e8c4ae69d5dd19c9b9ffdd8/src/fold.jl#L100-L112">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SeqFold._traceback" href="#SeqFold._traceback"><code>SeqFold._traceback</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Traceback thru the V(i,j) and W(i,j) caches to find the structure.</p><p>For each step, get to the lowest energy W(i,j) within that block. Store the structure in W(i,j). Inc i and j. If the next structure is viable according to V(i,j), store as well. Repeat.</p><p>Args:     i: The leftmost index to start searching in.     j: The rightmost index to start searching in.     v<em>cache: Cache of energies where i and j bond. Stores <code>Structure</code>.     w</em>cache: Cache of energies/sub-structures between or with i and j. Stores <code>Structure</code>.</p><p>Returns:     Vector{Structure}: A list of Structs in the final secondary structure.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/phlaster/SeqFold.jl/blob/469c9ece6f6d2d9a1e8c4ae69d5dd19c9b9ffdd8/src/fold.jl#L868-L885">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SeqFold._cache" href="#SeqFold._cache"><code>SeqFold._cache</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Create caches for the w<em>cache and v</em>cache</p><p>The Structs is useful for gathering many possible energies between a series of <code>(i,j)</code> combinations.</p><p>Args:     seq: The sequence to fold</p><p>Keyword Args:     temp: The temperature to fold at</p><p>Returns:     <code>(w_cache, v_cache)</code> tuple</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/phlaster/SeqFold.jl/blob/469c9ece6f6d2d9a1e8c4ae69d5dd19c9b9ffdd8/src/fold.jl#L184-L198">source</a></section></article><ul><li><a href="../#SeqFold.SeqFold"><code>SeqFold.SeqFold</code></a></li><li><a href="#SeqFold.DNA_BULGE_LOOPS"><code>SeqFold.DNA_BULGE_LOOPS</code></a></li><li><a href="#SeqFold.DNA_DE"><code>SeqFold.DNA_DE</code></a></li><li><a href="#SeqFold.DNA_HAIRPIN_LOOPS"><code>SeqFold.DNA_HAIRPIN_LOOPS</code></a></li><li><a href="#SeqFold.DNA_INTERNAL_LOOPS"><code>SeqFold.DNA_INTERNAL_LOOPS</code></a></li><li><a href="#SeqFold.DNA_INTERNAL_MM"><code>SeqFold.DNA_INTERNAL_MM</code></a></li><li><a href="#SeqFold.DNA_MULTIBRANCH"><code>SeqFold.DNA_MULTIBRANCH</code></a></li><li><a href="#SeqFold.DNA_NN"><code>SeqFold.DNA_NN</code></a></li><li><a href="#SeqFold.DNA_TERMINAL_MM"><code>SeqFold.DNA_TERMINAL_MM</code></a></li><li><a href="#SeqFold.DNA_TRI_TETRA_LOOPS"><code>SeqFold.DNA_TRI_TETRA_LOOPS</code></a></li><li><a href="../#SeqFold.MeltingConditions"><code>SeqFold.MeltingConditions</code></a></li><li><a href="../#SeqFold.Structure"><code>SeqFold.Structure</code></a></li><li><a href="#SeqFold._bulge"><code>SeqFold._bulge</code></a></li><li><a href="#SeqFold._cache"><code>SeqFold._cache</code></a></li><li><a href="#SeqFold._d_g"><code>SeqFold._d_g</code></a></li><li><a href="#SeqFold._hairpin"><code>SeqFold._hairpin</code></a></li><li><a href="#SeqFold._internal_loop"><code>SeqFold._internal_loop</code></a></li><li><a href="#SeqFold._j_s"><code>SeqFold._j_s</code></a></li><li><a href="#SeqFold._min_struct"><code>SeqFold._min_struct</code></a></li><li><a href="#SeqFold._multi_branch"><code>SeqFold._multi_branch</code></a></li><li><a href="#SeqFold._pair"><code>SeqFold._pair</code></a></li><li><a href="#SeqFold._stack"><code>SeqFold._stack</code></a></li><li><a href="#SeqFold._traceback"><code>SeqFold._traceback</code></a></li><li><a href="#SeqFold._trackback_energy"><code>SeqFold._trackback_energy</code></a></li><li><a href="#SeqFold._v!"><code>SeqFold._v!</code></a></li><li><a href="#SeqFold._w!"><code>SeqFold._w!</code></a></li><li><a href="../#SeqFold.dg"><code>SeqFold.dg</code></a></li><li><a href="#SeqFold.dg_cache"><code>SeqFold.dg_cache</code></a></li><li><a href="../#SeqFold.dot_bracket"><code>SeqFold.dot_bracket</code></a></li><li><a href="../#SeqFold.fold"><code>SeqFold.fold</code></a></li><li><a href="../#SeqFold.gc_cache"><code>SeqFold.gc_cache</code></a></li><li><a href="../#SeqFold.tm"><code>SeqFold.tm</code></a></li><li><a href="../#SeqFold.tm_cache"><code>SeqFold.tm_cache</code></a></li></ul></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Exported Functions</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Thursday 4 September 2025 22:12">Thursday 4 September 2025</span>. Using Julia version 1.11.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
