<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · SeqFold.jl</title><meta name="title" content="Home · SeqFold.jl"/><meta property="og:title" content="Home · SeqFold.jl"/><meta property="twitter:title" content="Home · SeqFold.jl"/><meta name="description" content="Documentation for SeqFold.jl."/><meta property="og:description" content="Documentation for SeqFold.jl."/><meta property="twitter:description" content="Documentation for SeqFold.jl."/><meta property="og:url" content="https://phlaster.github.io/SeqFold.jl/"/><meta property="twitter:url" content="https://phlaster.github.io/SeqFold.jl/"/><link rel="canonical" href="https://phlaster.github.io/SeqFold.jl/"/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href>SeqFold.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Home</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Home</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/phlaster/SeqFold.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/phlaster/SeqFold.jl/blob/master/docs/src/index.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="SeqFold"><a class="docs-heading-anchor" href="#SeqFold">SeqFold</a><a id="SeqFold-1"></a><a class="docs-heading-anchor-permalink" href="#SeqFold" title="Permalink"></a></h1><p>Documentation for <a href="https://github.com/phlaster/SeqFold.jl">SeqFold</a>.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SeqFold.SeqFold" href="#SeqFold.SeqFold"><code>SeqFold.SeqFold</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SeqFold.jl, v0.0.1</code></pre><p><strong>Introduction</strong></p><p><code>SeqFold.jl</code> is a high-performance Julia reimplementation of <a href="https://github.com/Lattice-Automation/seqfold"><code>seqfold</code></a> Python library for predicting nucleic acid secondary structures and calculating melting temperatures, which is, in turn,   is an implementation of the <code>Zuker, 1981</code> dynamic programming algorithm, the basis for   <a href="http://unafold.rna.albany.edu/?q=DINAMelt/software">UNAFold</a>/<a href="https://www.ibridgenetwork.org/#!/profiles/1045554571442/innovations/1/">mfold</a>,   with energy functions from <code>SantaLucia, 2004</code> (DNA) and <code>Turner, 2009</code> (RNA).</p><p><strong>Basic Usage</strong></p><p><strong>Melting Temperature Calculation</strong></p><pre><code class="language-julia hljs">julia&gt; seq = &quot;GGGAGGTCAGCAAACCTGAACCTGTTGAGATGTTGACGTCAGGAAACCCT&quot;;

julia&gt; tm(seq) # melting at PCR conditions, same as tm(seq, conditions=:pcr)
80.4

julia&gt; MeltingConditions(:pcr) # here they are as a preset inherited from seqfold library
MeltingConditions (PCR preset)
  • NEB PCR buffer conditions for Taq DNA Polymerase
  • seq1 concentration: 250.0 nM (typical primer concentration)
  • seq2 concentration: 0.0 nM (asymmetric PCR)
  • Mg²⁺: 1.5 mM (optimal for Taq DNA Polymerase per NEB guidelines)
  • K⁺: 50.0 mM
  • Tris: 2.0 mM
  • dNTPs: 0.2 mM

julia&gt; tm(seq, Mg=5) # altering default conditions
81.4

julia&gt; MeltingConditions(:std) # second preset, inherited from seqfold library
MeltingConditions (standard preset)
  • Standard hybridization buffer
  • seq1 concentration: 25.0 nM
  • seq2 concentration: 25.0 nM
  • Na⁺: 50.0 mM

julia&gt; tm(seq, conditions=:std, Na=150) # altering chosen preset
79.8

julia&gt; custom_conds = MeltingConditions( # Specifying custom conditions
       seq1_conc=30,seq2_conc=20,Na=5,K=5,Tris=15,Mg=0,dNTPs=0)
MeltingConditions (custom)
  • seq1 concentration: 30.0 nM
  • seq2 concentration: 20.0 nM
  • Na⁺: 5.0 mM
  • K⁺: 5.0 mM
  • Tris: 15.0 mM

julia&gt; tm(seq, conditions=custom_conds, Tris=50) # flexible adjustments
68.4</code></pre><p><strong>Secondary Structure Prediction</strong></p><pre><code class="language-julia hljs"># Get the list of possible secondary structures for a sequence
julia&gt; folded = fold(seq) # calculated at 37°C by default, Julia uses 1-based indexing
12-element Vector{SeqFold.Structure}:
    3   40   -1.3  STACK:GA/CT    
    4   39   -1.4  STACK:AGG/TGC  
    6   37   -1.5  STACK:GT/CA    
    7   36   -1.3  STACK:TC/AG    
    8   35   -1.5  STACK:CA/GT    
    9   34   -2.0  STACK:AGC/TTG  
   11   32   -1.5  STACK:CA/GT    
   12   31    2.8  INTERIOR_LOOP:4/2
   16   29   -1.3  STACK:CT/GA    
   17   28   -0.1  STACK:TGA/AGT  
   19   26   -1.0  STACK:AA/TT    
   20   25    3.5  HAIRPIN:AC/TG 

julia&gt; dot_bracket(seq, folded) # get the dot-bracket notation
&quot;..((.((((.((...((.((....)).)).)).)))).))..........&quot;

julia&gt; folded_hot = fold(seq, temp=80)
4-element Vector{SeqFold.Structure}:
    7   19   -0.4  STACK:TC/AG    
    8   18   -0.5  STACK:CA/GT    
    9   17   -0.4  STACK:AG/TC    
   10   16    3.6  HAIRPIN:GC/CC 

julia&gt; dot_bracket(seq, folded_hot) # at a higher temperature number of secondary structures is decreased
&quot;......((((.....))))...............................&quot;

julia&gt; dg(folded) # get the total free energy of the predicted secondary structures
-6.6

julia&gt; dg(folded_hot)
2.3

julia&gt; dg(seq, temp=4) # this method calls the computationally intensive `fold` internally
-16.2</code></pre><p><strong>Citations</strong></p><p>Papers, which helped in developing the original <code>seqfold</code> package:</p><ul><li><strong>Nussinov, 1980:</strong><blockquote><p>Nussinov, Ruth, and Ann B. Jacobson. &quot;Fast algorithm for predicting the secondary structure of single-stranded RNA.&quot; Proceedings of the National Academy of Sciences 77.11 (1980): 6309-6313.</p></blockquote></li><li><strong>Zuker, 1981:</strong><blockquote><p>Zuker, Michael, and Patrick Stiegler. &quot;Optimal computer folding of large RNA sequences using thermodynamics and auxiliary information.&quot; Nucleic acids research 9.1 (1981): 133-148.</p></blockquote></li><li><strong>Jaeger, 1989:</strong><blockquote><p>Jaeger, John A., Douglas H. Turner, and Michael Zuker. &quot;Improved predictions of secondary structures for RNA.&quot; Proceedings of the National Academy of Sciences 86.20 (1989): 7706-7710.</p></blockquote></li><li><strong>SantaLucia, 2004:</strong><blockquote><p>SantaLucia Jr, John, and Donald Hicks. &quot;The thermodynamics of DNA structural motifs.&quot; Annu. Rev. Biophys. Biomol. Struct. 33 (2004): 415-440.</p></blockquote></li><li><strong>Turner, 2009:</strong><blockquote><p>Turner, Douglas H., and David H. Mathews. &quot;NNDB: the nearest neighbor parameter database for predicting stability of nucleic acid secondary structure.&quot; Nucleic acids research 38.suppl_1 (2009): D280-D282.</p></blockquote></li><li><strong>Ward, 2017:</strong><blockquote><p>Ward, M., Datta, A., Wise, M., &amp; Mathews, D. H. (2017). Advanced multi-loop algorithms for RNA secondary structure prediction reveal that the simplest model is best. Nucleic acids research, 45(14), 8541-8550.</p></blockquote></li></ul><p><strong>Exports:</strong></p><p><a href="#SeqFold.tm-Tuple{AbstractString, AbstractString}"><code>tm</code></a>, <a href="#SeqFold.MeltingConditions"><code>MeltingConditions</code></a>, <a href="#SeqFold.fold-Tuple{AbstractString}"><code>fold</code></a>, <a href="#SeqFold.dg-Tuple{AbstractString}"><code>dg</code></a>, <a href="#SeqFold.dot_bracket-Tuple{AbstractString, Vector{SeqFold.Structure}}"><code>dot_bracket</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/phlaster/SeqFold.jl/blob/836e9c81532845afd2cb9655d1d32339af973583/src/SeqFold.jl#L11-L132">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SeqFold.DNA_BULGE_LOOPS" href="#SeqFold.DNA_BULGE_LOOPS"><code>SeqFold.DNA_BULGE_LOOPS</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Enthalpy and entropy increments for length depedence of bulge loops</p><p>Were calculated from delta G Table 4 of SantaLucia, 2004:</p><p>Annu.Rev.Biophs.Biomol.Struct.33:415-40 doi: 10.1146/annurev.biophys.32.110601.141800 The Thermodynamics of DNA Structural Motifs SantaLucia and Hicks, 2004</p><p>For bulge loops of size 1, the intervening NN energy is used. Closing AT penalty is applied on both sides</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/phlaster/SeqFold.jl/blob/836e9c81532845afd2cb9655d1d32339af973583/src/dna.jl#L415-L427">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SeqFold.DNA_DE" href="#SeqFold.DNA_DE"><code>SeqFold.DNA_DE</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>DNA dangling ends:</p><ul><li>Bommarito et al. (2000), Nucl Acids Res 28: 1929-1934</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/phlaster/SeqFold.jl/blob/836e9c81532845afd2cb9655d1d32339af973583/src/dna.jl#L151-L154">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SeqFold.DNA_HAIRPIN_LOOPS" href="#SeqFold.DNA_HAIRPIN_LOOPS"><code>SeqFold.DNA_HAIRPIN_LOOPS</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Enthalpy and entropy increments for length depedence of hairpin loops</p><p>Were calculated from delta G Table 4 of SantaLucia, 2004:</p><p>Annu.Rev.Biophs.Biomol.Struct.33:415-40 doi: 10.1146/annurev.biophys.32.110601.141800 The Thermodynamics of DNA Structural Motifs SantaLucia and Hicks, 2004</p><p>For hairpins of length 3 and 4, the entropy values are looked up in the DNA<em>TRI</em>TETRA_LOOPS Dict</p><p>From formula 8-9 of the paper: An additional 1.6 delta entropy penalty if the hairpin is closed by AT</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/phlaster/SeqFold.jl/blob/836e9c81532845afd2cb9655d1d32339af973583/src/dna.jl#L461-L476">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SeqFold.DNA_INTERNAL_LOOPS" href="#SeqFold.DNA_INTERNAL_LOOPS"><code>SeqFold.DNA_INTERNAL_LOOPS</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Enthalpy and entropy increments for length dependence of internal loops</p><p>Were calculated from delta G Table 4 of SantaLucia, 2004:</p><p>Annu.Rev.Biophs.Biomol.Struct.33:415-40 doi: 10.1146/annurev.biophys.32.110601.141800 The Thermodynamics of DNA Structural Motifs SantaLucia and Hicks, 2004</p><p>Additional loop sizes are accounted for with the Jacobson-Stockmayer entry extrapolation formula in paper: delta G (loop-n) = delta G (loop-x) + 2.44 x R x 310.15 x ln(n / x)</p><p>Additional correction is applied for asymmetric loops in paper: delta G (asymmetry) = |length A - length B| x 0.3 (kcal / mol) where A and B are lengths of both sides of loop</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/phlaster/SeqFold.jl/blob/836e9c81532845afd2cb9655d1d32339af973583/src/dna.jl#L364-L381">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SeqFold.DNA_INTERNAL_MM" href="#SeqFold.DNA_INTERNAL_MM"><code>SeqFold.DNA_INTERNAL_MM</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Internal mismatch table (DNA):</p><ul><li>Allawi &amp; SantaLucia (1997), Biochemistry 36: 10581-10594</li><li>Allawi &amp; SantaLucia (1998), Biochemistry 37: 9435-9444</li><li>Allawi &amp; SantaLucia (1998), Biochemistry 37: 2170-2179 * </li><li>Allawi &amp; SantaLucia (1998), Nucl Acids Res 26: 2694-2701 *</li><li>Peyret et al. (1999), Biochemistry 38: 3468-3477 *</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/phlaster/SeqFold.jl/blob/836e9c81532845afd2cb9655d1d32339af973583/src/dna.jl#L34-L41">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SeqFold.DNA_MULTIBRANCH" href="#SeqFold.DNA_MULTIBRANCH"><code>SeqFold.DNA_MULTIBRANCH</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>a, b, c, d in a linear multi-branch energy change function.</p><p>Inferred from: Supplemental Material: Annu.Rev.Biophs.Biomol.Struct.33:415-40 doi: 10.1146/annurev.biophys.32.110601.141800 The Thermodynamics of DNA Structural Motifs SantaLucia and Hicks, 2004</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/phlaster/SeqFold.jl/blob/836e9c81532845afd2cb9655d1d32339af973583/src/dna.jl#L3-L11">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SeqFold.DNA_NN" href="#SeqFold.DNA_NN"><code>SeqFold.DNA_NN</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>The Thermodynamics of DNA Structural Motifs</p><ul><li>SantaLucia and Hicks, 2004</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/phlaster/SeqFold.jl/blob/836e9c81532845afd2cb9655d1d32339af973583/src/dna.jl#L13-L16">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SeqFold.DNA_TERMINAL_MM" href="#SeqFold.DNA_TERMINAL_MM"><code>SeqFold.DNA_TERMINAL_MM</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Terminal mismatch table (DNA):</p><ul><li>SantaLucia &amp; Peyret (2001) Patent Application WO 01/94611</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/phlaster/SeqFold.jl/blob/836e9c81532845afd2cb9655d1d32339af973583/src/dna.jl#L96-L99">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SeqFold.DNA_TRI_TETRA_LOOPS" href="#SeqFold.DNA_TRI_TETRA_LOOPS"><code>SeqFold.DNA_TRI_TETRA_LOOPS</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Experimental delta H and delta S for tri/tetra loops:</p><ul><li>Supplemental Material: Annu.Rev.Biophs.Biomol.Struct.33:415-40</li></ul><p>doi: 10.1146/annurev.biophys.32.110601.141800 The Thermodynamics of DNA Structural Motifs SantaLucia and Hicks, 2004</p><ul><li>delta S was computed using delta G and delta H and is in cal / (K x mol)</li></ul><p>(versus delta H in kcal / mol)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/phlaster/SeqFold.jl/blob/836e9c81532845afd2cb9655d1d32339af973583/src/dna.jl#L220-L229">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SeqFold.MeltingConditions" href="#SeqFold.MeltingConditions"><code>SeqFold.MeltingConditions</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">MeltingConditions(seq1_conc, seq2_conc, Na, K, Tris, Mg, dNTPs)</code></pre><p>Represents buffer conditions for melting temperature calculation.</p><p><strong>Fields and Units</strong></p><ul><li><code>seq1_conc</code>, <code>seq2_conc</code>: Sequence concentrations in <strong>nM</strong> (nanomolar)</li><li><code>Na</code>, <code>K</code>, <code>Tris</code>, <code>Mg</code>, <code>dNTPs</code>: Buffer component concentrations in <strong>mM</strong> (millimolar)</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; MeltingConditions(:pcr)
MeltingConditions (PCR preset)
  • NEB PCR buffer conditions for Taq DNA Polymerase
  • seq1 concentration: 250.0 nM (typical primer concentration)
  • seq2 concentration: 0.0 nM (asymmetric PCR)
  • Mg²⁺: 1.5 mM (optimal for Taq DNA Polymerase per NEB guidelines)
  • K⁺: 50.0 mM
  • Tris: 2.0 mM
  • dNTPs: 0.2 mM

julia&gt; MeltingConditions(:std)
MeltingConditions (standard preset)
  • Standard hybridization buffer
  • seq1 concentration: 25.0 nM
  • seq2 concentration: 25.0 nM
  • Na⁺: 50.0 mM

julia&gt; MeltingConditions(seq1_conc=10,seq2_conc=0,Na=0,K=0,Tris=10,Mg=0,dNTPs=0)
MeltingConditions (custom)
  • seq1 concentration: 10.0 nM
  • seq2 concentration: 0.0 nM
  • Tris: 10.0 mM

julia&gt; MeltingConditions(10,0,0,0,0,5,0)
MeltingConditions (custom)
  • seq1 concentration: 10.0 nM
  • seq2 concentration: 0.0 nM
  • Mg²⁺: 5.0 mM (higher than NEB&#39;s recommended 1.5-2.0 mM range)

julia&gt; MeltingConditions(seq1_conc=0,seq2_conc=0,Na=5,K=0,Tris=0,Mg=0,dNTPs=0)
ERROR: ArgumentError: DNA concentration is too low!
[...]

julia&gt; MeltingConditions(seq1_conc=10,seq2_conc=10,Na=0,K=0,Tris=0,Mg=0,dNTPs=0)
ERROR: ArgumentError: No cations for salt correction (Mg=0, Na=0, K=0, Tris=0)
[...]</code></pre><p><strong>See also</strong></p><p><a href="#SeqFold.tm-Tuple{AbstractString, AbstractString}"><code>tm</code></a>, <a href="#SeqFold.tm_cache-Tuple{AbstractString, AbstractString}"><code>SeqFold.tm_cache</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/phlaster/SeqFold.jl/blob/836e9c81532845afd2cb9655d1d32339af973583/src/types.jl#L131-L183">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SeqFold.Structure" href="#SeqFold.Structure"><code>SeqFold.Structure</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Structure(e, desc, ij)</code></pre><p>Represents a structural element within a predicted nucleic acid secondary structure.</p><p>A <code>Structure</code> object encapsulates the energetic contribution (<code>e</code>), a descriptive string (<code>desc</code>) detailing the type of structural element (e.g., hairpin, stack, bulge, multibranch), and the base-pairing information (<code>ij</code>).</p><p>This type is primarily used internally by the folding algorithm (see <a href="#SeqFold.fold-Tuple{AbstractString}"><code>fold</code></a>) to represent and cache the energetics of different structural motifs. It can also be used to inspect the detailed components of a folded structure.</p><p><strong>Fields</strong></p><ul><li><code>e::Float64</code>: The free energy contribution (in kcal/mol) of this structural element. A value of <code>-Inf</code> typically signifies an uninitialized or invalid structure, while <code>Inf</code> often represents a null or discarded possibility during folding.</li><li><code>desc::String</code>: A human-readable description of the structural element. Common descriptions include:<ul><li><code>&quot;HAIRPIN:&lt;seq&gt;&quot;</code>: A hairpin loop closed by specific base pairs.</li><li><code>&quot;STACK:&lt;bp1&gt;/&lt;bp2&gt;&quot;</code>: A stacked base pair.</li><li><code>&quot;BULGE:&lt;size&gt;&quot;</code>: A bulge loop of a specific size.</li><li><code>&quot;INTERIOR_LOOP:&lt;size1&gt;/&lt;size2&gt;&quot;</code>: An interior loop with specified sizes on each side.</li><li><code>&quot;BIFURCATION:&lt;unpaired&gt;n/&lt;helices&gt;h&quot;</code>: A multibranch loop with a certain number of unpaired nucleotides and helices.</li></ul></li><li><code>ij::Vector{Tuple{Int, Int}}</code>: A list of base-pair indices <code>(i, j)</code> involved in this structural element. For simple elements like a single hairpin or stack, this typically contains one tuple <code>(i, j)</code> indicating the 1-based indices of the paired nucleotides. For complex elements like multibranch loops, it can contain multiple tuples representing the various stems (helices) that constitute the junction.</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; s1 = SeqFold.Structure() # Default, uninitialized
   0    0   -Inf

julia&gt; s2 = SeqFold.Structure(-3.2, &quot;HAIRPIN:CG/CG&quot;, [(2, 7)])
   2    7   -3.2  HAIRPIN:CG/CG

julia&gt; s3 = SeqFold.Structure(5.1, &quot;BIFURCATION:2n/3h&quot;, [(1, 10), (15, 20), (25, 30)])
   1   10    5.1  BIFURCATION:2n/3h

julia&gt; Bool(s1) # Check if structure is valid (not -Inf)
false

julia&gt; Bool(s2)
true

julia&gt; s2 == SeqFold.Structure(-3.2, &quot;HAIRPIN:CG/CG&quot;, [(2, 7)]) # Structures can be compared
true</code></pre><p><strong>See also</strong></p><p><a href="#SeqFold.fold-Tuple{AbstractString}"><code>fold</code></a>, <a href="#SeqFold.dg-Tuple{AbstractString}"><code>dg</code></a>, <a href="#SeqFold.dot_bracket-Tuple{AbstractString, Vector{SeqFold.Structure}}"><code>dot_bracket</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/phlaster/SeqFold.jl/blob/836e9c81532845afd2cb9655d1d32339af973583/src/types.jl#L46-L104">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SeqFold._bulge-NTuple{7, Any}" href="#SeqFold._bulge-NTuple{7, Any}"><code>SeqFold._bulge</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Calculate the free energy associated with a bulge.</p><p>Args:     seq: The full folding DNA/RNA sequence (uppercase).     i: The start index of the bulge.     i1: The index to the right of i.     j: The end index of the bulge.     j1: The index to the left of j.     temp: Temperature in Kelvin.     emap: Map to DNA/RNA energies (<code>Energies</code> struct).</p><p>Returns:     Float64: The increment in free energy from the bulge.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/phlaster/SeqFold.jl/blob/836e9c81532845afd2cb9655d1d32339af973583/src/fold.jl#L601-L615">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SeqFold._cache-Tuple{Any, Any}" href="#SeqFold._cache-Tuple{Any, Any}"><code>SeqFold._cache</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Create caches for the w<em>cache and v</em>cache</p><p>The Structs is useful for gathering many possible energies between a series of <code>(i,j)</code> combinations.</p><p>Args:     seq: The sequence to fold</p><p>Keyword Args:     temp: The temperature to fold at</p><p>Returns:     <code>(w_cache, v_cache)</code> tuple</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/phlaster/SeqFold.jl/blob/836e9c81532845afd2cb9655d1d32339af973583/src/fold.jl#L184-L198">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SeqFold._d_g-Tuple{Any, Any, Any}" href="#SeqFold._d_g-Tuple{Any, Any, Any}"><code>SeqFold._d_g</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Find the free energy given delta h, s and temp</p><p>Args:     <code>d_h</code>: The enthalpy increment in kcal / mol     <code>d_s</code>: The entropy increment in cal / mol     <code>temp_K</code>: The temperature in Kelvin</p><p>Returns:     The free energy increment in kcal / (mol x K)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/phlaster/SeqFold.jl/blob/836e9c81532845afd2cb9655d1d32339af973583/src/fold.jl#L434-L444">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SeqFold._hairpin-NTuple{5, Any}" href="#SeqFold._hairpin-NTuple{5, Any}"><code>SeqFold._hairpin</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Calculate the free energy of a hairpin.</p><p>Args:     seq: The sequence we&#39;re folding (uppercase).     i: The index of the start of hairpin.     j: The index of the end of hairpin (1-based, inclusive).     temp: Temperature in Kelvin.     emap: Energy map for DNA/RNA (<code>Energies</code> struct).</p><p>Returns:     Float64: The free energy increment from the hairpin structure.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/phlaster/SeqFold.jl/blob/836e9c81532845afd2cb9655d1d32339af973583/src/fold.jl#L537-L549">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SeqFold._internal_loop-NTuple{7, Any}" href="#SeqFold._internal_loop-NTuple{7, Any}"><code>SeqFold._internal_loop</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Calculate the free energy of an internal loop.</p><p>The first and last bp of both left and right sequences are not themselves parts of the loop, but are the terminal bp on either side of it. They are needed for when there&#39;s a single internal looping bp (where just the mismatching free energies are used).</p><p>Note that both left and right sequences are in 5&#39; to 3&#39; direction.</p><p>This is adapted from the &quot;Internal Loops&quot; section of SantaLucia/Hicks, 2004.</p><p>Args:     seq: The sequence we&#39;re folding (uppercase).     i: The index of the start of structure on left side.     i1: The index to the right of i.     j: The index of the end of structure on right side.     j1: The index to the left of j.     temp: Temperature in Kelvin.     emap: Dictionary mapping to energies for DNA/RNA (<code>Energies</code> struct).</p><p>Returns:     Float64: The free energy associated with the internal loop.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/phlaster/SeqFold.jl/blob/836e9c81532845afd2cb9655d1d32339af973583/src/fold.jl#L650-L674">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SeqFold._j_s-NTuple{4, Any}" href="#SeqFold._j_s-NTuple{4, Any}"><code>SeqFold._j_s</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Estimate the free energy of length <code>query_len</code> based on one of length <code>known_len</code>.</p><p>The Jacobson-Stockmayer entry extrapolation formula is used for bulges, hairpins, etc that fall outside the 30nt upper limit for pre-calculated free-energies. See SantaLucia and Hicks (2004).</p><p>Args:     query<em>len: Length of element without known free energy value     known</em>len: Length of element with known free energy value (d<em>g</em>x)     d<em>g</em>x: The free energy of the element known<em>len     temp</em>K: Temperature in Kelvin</p><p>Returns:     Free energy for a structure of length <code>query_len</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/phlaster/SeqFold.jl/blob/836e9c81532845afd2cb9655d1d32339af973583/src/fold.jl#L448-L463">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SeqFold._min_struct-Tuple" href="#SeqFold._min_struct-Tuple"><code>SeqFold._min_struct</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Return the struct with the lowest free energy that isn&#39;t -inf (undef)</p><p>Args:     structs: Structures being compared</p><p>Returns:     struct: The min free energy structure</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/phlaster/SeqFold.jl/blob/836e9c81532845afd2cb9655d1d32339af973583/src/fold.jl#L416-L424">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SeqFold._multi_branch" href="#SeqFold._multi_branch"><code>SeqFold._multi_branch</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Calculate a multi-branch energy penalty using a linear formula.</p><p>From Jaeger, Turner, and Zuker, 1989. Found to be better than logarithmic in Ward, et al. 2017.</p><p>Args:     seq: The sequence being folded (uppercase).     i: The left starting index.     k: The mid-point in the search.     j: The right ending index.     temp: Folding temp in Kelvin.     v<em>cache: Cache of energies where V(i,j) bond. Stores <code>Structure</code>.     w</em>cache: Cache of min energy of substructures between W(i,j). Stores <code>Structure</code>.     emap: Map to DNA/RNA energies (<code>Energies</code> struct).     helix: Whether this multibranch is enclosed by a helix (V(i,j) forms a base pair).</p><p>Returns:     Structure: A multi-branch structure.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/phlaster/SeqFold.jl/blob/836e9c81532845afd2cb9655d1d32339af973583/src/fold.jl#L727-L746">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SeqFold._pair-NTuple{5, Any}" href="#SeqFold._pair-NTuple{5, Any}"><code>SeqFold._pair</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Return a stack representation, a key for the NN maps</p><p>Args:     s: Sequence being folded     i: leftmost index     i1: index to right of i     j: rightmost index     j1: index to left of j</p><p>Returns:     string representation of the pair</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/phlaster/SeqFold.jl/blob/836e9c81532845afd2cb9655d1d32339af973583/src/fold.jl#L399-L411">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SeqFold._stack-NTuple{7, Any}" href="#SeqFold._stack-NTuple{7, Any}"><code>SeqFold._stack</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Get the free energy for a stack. Using the indexes i and j, check whether it&#39;s at the end of the sequence or internal. Then check whether it&#39;s a match or mismatch, and return. Two edge-cases are terminal mismatches and dangling ends. The energy of a dangling end is added to the energy of a pair where i XOR j is at the sequence&#39;s end.</p><p>Args:     seq: The full folding sequence (uppercase).     i: The start index on left side of the pair/stack.     i1: The index to the right of i.     j: The end index on right side of the pair/stack.     j1: The index to the left of j.     temp: Temperature in Kelvin.     emap: Energy map for DNA/RNA (<code>Energies</code> struct).</p><p>Returns:     Float64: The free energy of the NN pairing.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/phlaster/SeqFold.jl/blob/836e9c81532845afd2cb9655d1d32339af973583/src/fold.jl#L468-L488">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SeqFold._traceback-NTuple{4, Any}" href="#SeqFold._traceback-NTuple{4, Any}"><code>SeqFold._traceback</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Traceback thru the V(i,j) and W(i,j) caches to find the structure.</p><p>For each step, get to the lowest energy W(i,j) within that block. Store the structure in W(i,j). Inc i and j. If the next structure is viable according to V(i,j), store as well. Repeat.</p><p>Args:     i: The leftmost index to start searching in.     j: The rightmost index to start searching in.     v<em>cache: Cache of energies where i and j bond. Stores <code>Structure</code>.     w</em>cache: Cache of energies/sub-structures between or with i and j. Stores <code>Structure</code>.</p><p>Returns:     Vector{Structure}: A list of Structs in the final secondary structure.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/phlaster/SeqFold.jl/blob/836e9c81532845afd2cb9655d1d32339af973583/src/fold.jl#L868-L885">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SeqFold._trackback_energy-Tuple{Any}" href="#SeqFold._trackback_energy-Tuple{Any}"><code>SeqFold._trackback_energy</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Add energy to each structure, based on how it&#39;s W(i,j) differs from the one after.</p><p>Args:     structs: The structures for whom energy is being calculated.</p><p>Returns:     Vector{Structure}: Structures in the folded DNA with energy.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/phlaster/SeqFold.jl/blob/836e9c81532845afd2cb9655d1d32339af973583/src/fold.jl#L938-L946">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SeqFold._v!-NTuple{7, Any}" href="#SeqFold._v!-NTuple{7, Any}"><code>SeqFold._v!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Find, store and return the minimum free energy of the structure between i and j. If i and j don&#39;t base pair, store and return INF. See: Figure 2B of Zuker, 1981</p><p>Args:     seq: The sequence being folded (uppercase).     i: The start index.     j: The end index (1-based, inclusive).     temp: The temperature in Kelvin.     v<em>cache: Free energy cache for if i and j base pair. Stores <code>Structure</code>.     w</em>cache: Free energy cache for lowest energy structure from i to j. Stores <code>Structure</code>.     emap: Energy map for DNA/RNA (<code>Energies</code> struct).</p><p>Returns:     Structure: The minimum free energy structure possible between i and j.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/phlaster/SeqFold.jl/blob/836e9c81532845afd2cb9655d1d32339af973583/src/fold.jl#L262-L278">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SeqFold._w!-NTuple{7, Any}" href="#SeqFold._w!-NTuple{7, Any}"><code>SeqFold._w!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Find and return the lowest free energy structure in Sij subsequence (1-based indices). This function calculates and stores results in <code>w_cache</code> to avoid recomputation. Figure 2B in Zuker and Stiegler, 1981.</p><p>Args:     seq: The sequence being folded.     i: The start index.     j: The end index (1-based, inclusive).     temp: The temperature in Kelvin.     v<em>cache: Free energy cache for if i and j base pair. Stores <code>Structure</code>.     w</em>cache: Free energy cache for lowest energy structure from i to j. Stores <code>Structure</code>.     emap: Energy map for DNA/RNA (<code>Energies</code> struct).</p><p>Returns:     Structure: The minimum free energy structure for the subsequence from i to j.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/phlaster/SeqFold.jl/blob/836e9c81532845afd2cb9655d1d32339af973583/src/fold.jl#L216-L232">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SeqFold.dg-Tuple{AbstractString}" href="#SeqFold.dg-Tuple{AbstractString}"><code>SeqFold.dg</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">dg(seq; temp = 37.0) -&gt; Float64
dg(structures) -&gt; Float64</code></pre><p>Compute the minimum free energy (ΔG, kcal/mol⁻¹) of a single-stranded nucleic acid sequence at a specified temperature.</p><p>The function is a thin wrapper around the more general <code>fold</code> routine, which generates all energetically feasible secondary structures for the sequence.   Only the sum of the free-energy contributions of the returned structures is reported, rounded to two decimal places.</p><p><strong>Arguments</strong></p><ul><li><code>seq::AbstractString</code> – the nucleotide sequence to be folded;</li><li><code>temp::Real</code> – the temperature (°C) at which to perform the folding (default: <code>37.0</code>);</li><li><code>structures::Vector{Structure}</code> – result of <a href="#SeqFold.fold-Tuple{AbstractString}"><code>fold</code></a> function.</li></ul><p><strong>Returns</strong></p><ul><li><code>ΔG::Float64</code> – the total free energy of the predicted structure, rounded to two decimal places.</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; seq = &quot;GCGCGCGCGCG&quot;;

julia&gt; dg(seq)
-3.0

julia&gt; dg(seq, temp=20)
-4.9

julia&gt; structures = fold(seq);

julia&gt; dg(structures)
-3.0</code></pre><p><strong>See also</strong></p><p><a href="#SeqFold.fold-Tuple{AbstractString}"><code>fold</code></a>, <a href="#SeqFold.dg_cache"><code>SeqFold.dg_cache</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/phlaster/SeqFold.jl/blob/836e9c81532845afd2cb9655d1d32339af973583/src/fold.jl#L48-L88">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SeqFold.dg_cache" href="#SeqFold.dg_cache"><code>SeqFold.dg_cache</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Fold a nucleic acid sequence and return the estimated ΔG of each (i,j) pairing.</p><p>Args:     seq: The nucleic acid sequence to fold</p><p>Keyword Args:     temp: The temperature to fold at</p><p>Returns:     Cache: A Vector{Vector} where each [i][j] pairing corresponds to the         minimum free energy between i and j</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/phlaster/SeqFold.jl/blob/836e9c81532845afd2cb9655d1d32339af973583/src/fold.jl#L100-L112">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SeqFold.dot_bracket-Tuple{AbstractString, Vector{SeqFold.Structure}}" href="#SeqFold.dot_bracket-Tuple{AbstractString, Vector{SeqFold.Structure}}"><code>SeqFold.dot_bracket</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">dot_bracket(seq, structs) -&gt; String</code></pre><p>Generate the dot-bracket notation representation of a predicted nucleic acid secondary structure.</p><p><strong>Arguments</strong></p><ul><li><code>seq::AbstractString</code>: The original nucleotide sequence that was folded.</li><li><code>structs::Vector{Structure}</code>: A vector of <code>Structure</code> objects describing the folded structure, typically obtained from the <a href="#SeqFold.fold-Tuple{AbstractString}"><code>fold</code></a> function.</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; s = &quot;AATTACGTTAC&quot;;

julia&gt; dot_bracket(s, fold(s))
&quot;((.....))..&quot;

julia&gt; seq2 = &quot;GGGAGGTCAGCAAACCTGAACCTGTTGAGATGTTGACGTCAGGAAACCCT&quot;;

julia&gt; structs2 = fold(seq2)
12-element Vector{SeqFold.Structure}:
    3   40   -1.3  STACK:GA/CT    
    4   39   -1.4  STACK:AGG/TGC  
    6   37   -1.5  STACK:GT/CA    
    7   36   -1.3  STACK:TC/AG    
    8   35   -1.5  STACK:CA/GT    
    9   34   -2.0  STACK:AGC/TTG  
   11   32   -1.5  STACK:CA/GT    
   12   31    2.8  INTERIOR_LOOP:4/2
   16   29   -1.3  STACK:CT/GA    
   17   28   -0.1  STACK:TGA/AGT  
   19   26   -1.0  STACK:AA/TT    
   20   25    3.5  HAIRPIN:AC/TG   

julia&gt; dbn = dot_bracket(seq2, structs2)
&quot;..((.((((.((...((.((....)).)).)).)))).))..........&quot;

julia&gt; length(dbn) == length(seq2)
true

julia&gt; count(==(&#39;(&#39;), dbn)  # Count base pairs
12</code></pre><p><strong>Notes</strong></p><ul><li>The function only considers the base pairs explicitly listed in the <code>.ij</code> field of each <code>Structure</code>.</li><li>It does not validate that the input structures are consistent or represent a physically possible configuration.</li><li>Pseudoknots (non-nested base pairs) are not handled by this simple representation and will not be correctly shown if present in the input structures.</li></ul><p><strong>See also</strong></p><p><a href="#SeqFold.fold-Tuple{AbstractString}"><code>fold</code></a>, <a href="#SeqFold.Structure"><code>SeqFold.Structure</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/phlaster/SeqFold.jl/blob/836e9c81532845afd2cb9655d1d32339af973583/src/fold.jl#L118-L170">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SeqFold.fold-Tuple{AbstractString}" href="#SeqFold.fold-Tuple{AbstractString}"><code>SeqFold.fold</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fold(seq; temp = 37.0) -&gt; Vector{Structure}</code></pre><p>Predict the minimum free energy secondary structure of a nucleic acid sequence using a dynamic programming algorithm based on the Zuker and Stiegler (1981) approach. https://www.ncbi.nlm.nih.gov/pmc/articles/PMC326673/pdf/nar00394-0137.pdf</p><p>Implements the core of the nucleic acid folding algorithm. It calculates the thermodynamically most stable secondary structure for a given single-stranded DNA or RNA sequence. The result is a vector of  <a href="#SeqFold.Structure"><code>Structure</code></a> objects, each element representing a distinct secondary structure (e.g., hairpin loop, stacked pair, bulge, interior loop, multibranch loop) that contributes to the overall folded structure.</p><p>An optimization is applied where &quot;isolated&quot; base pairs (those not adjacent to other base pairs) are penalized with a high energy cost (1600.0 kcal/mol) to speed up computation. A base pair (i,j) is considered isolated if neither the pair (i-1, j+1) nor the pair (i+1, j-1) are complementary according to the sequence&#39;s complementarity rules. This optimization is applied regardless of sequence length.</p><p><strong>Arguments</strong></p><ul><li><code>seq::AbstractString</code>: DNA/RNA sequence</li><li><code>temp::Real</code>: The temperature (°C) at which the folding is performed (default: <code>37.0</code>).</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; fold(&quot;CCAACCGGTTGG&quot;)
4-element Vector{SeqFold.Structure}:
    1   12   -1.8  STACK:CC/GG    
    2   11   -1.5  STACK:CA/GT    
    3   10   -1.0  STACK:AA/TT    
    4    9    3.5  HAIRPIN:AC/TG  

julia&gt; fold(&quot;CCAACCGGTTGG&quot;, temp=70)
2-element Vector{SeqFold.Structure}:
    5   12   -1.6  STACK_DE:CC/GG 
    6   11    3.2  HAIRPIN:CG/GT  </code></pre><p><strong>See also</strong></p><p><a href="#SeqFold.dg-Tuple{AbstractString}"><code>dg</code></a>, <a href="#SeqFold.dg_cache"><code>SeqFold.dg_cache</code></a>, <a href="#SeqFold.dot_bracket-Tuple{AbstractString, Vector{SeqFold.Structure}}"><code>dot_bracket</code></a>, <a href="#SeqFold.Structure"><code>SeqFold.Structure</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/phlaster/SeqFold.jl/blob/836e9c81532845afd2cb9655d1d32339af973583/src/fold.jl#L1-L41">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SeqFold.gc_cache-Tuple{AbstractString}" href="#SeqFold.gc_cache-Tuple{AbstractString}"><code>SeqFold.gc_cache</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">gc_cache(seq) -&gt; Matrix{Float64}</code></pre><p>Compute a matrix of GC scores for all possible subsequences of a DNA sequence.</p><p>The resulting matrix has element <code>[i, j]</code> representing the GC score of the DNA subsequence from position <code>i</code> to position <code>j</code>. This cache enables efficient GC ratio calculations for various subsequences without redundant computations.</p><p><strong>Arguments</strong></p><ul><li><code>seq::AbstractString</code>: The DNA sequence to analyze</li></ul><p><strong>Returns</strong></p><p>A <code>Matrix{Float64}</code> where element <code>[i, j]</code> contains the GC ratio of the subsequence from position <code>i</code> to <code>j</code>, rounded to one decimal place. Elements where <code>j &lt; i</code> contain <code>Inf</code> as they represent invalid ranges.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; SeqFold.gc_cache(&quot;GGAA&quot;)
4×4 Matrix{Float64}:
  1.0   1.0   0.666667  0.5
 Inf    1.0   0.5       0.333333
 Inf   Inf    0.0       0.0
 Inf   Inf   Inf        0.0

julia&gt; SeqFold.gc_cache(&quot;GAAA&quot;)
4×4 Matrix{Float64}:
  1.0   0.5   0.333333  0.25
 Inf    0.0   0.0       0.0
 Inf   Inf    0.0       0.0
 Inf   Inf   Inf        0.0

julia&gt; SeqFold.gc_cache(&quot;ATA&quot;)
3×3 Matrix{Float64}:
  0.0   0.0  0.0
 Inf    0.0  0.0
 Inf   Inf   0.0

julia&gt; SeqFold.gc_cache(&quot;GGTT&quot;) == SeqFold.gc_cache(&quot;CCAA&quot;)
true</code></pre><p><strong>See also</strong></p><p><a href="#SeqFold.tm_cache-Tuple{AbstractString, AbstractString}"><code>SeqFold.tm_cache</code></a>, <a href="#SeqFold.tm-Tuple{AbstractString, AbstractString}"><code>tm</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/phlaster/SeqFold.jl/blob/836e9c81532845afd2cb9655d1d32339af973583/src/tm.jl#L221-L265">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SeqFold.tm-Tuple{AbstractString, AbstractString}" href="#SeqFold.tm-Tuple{AbstractString, AbstractString}"><code>SeqFold.tm</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">tm(seq1, seq2; conditions=:pcr, kwargs...) -&gt; Float64
tm(seq; conditions=:pcr, kwargs...)  -&gt; Float64</code></pre><p>Calculate melting temperature (Tm °C) for DNA duplex formation using nearest-neighbor thermodynamics.</p><p><strong>Arguments</strong></p><ul><li><code>seq1::AbstractString</code>: DNA sequence;</li><li><code>seq2::AbstractString</code>: Another DNA sequence, must be the same length as <code>seq1</code>;</li><li><code>seq::AbstractString</code>: Single DNA sequence to be matched with its exact complement;</li><li><code>conditions</code>: Buffer conditions specification (see below);</li><li><code>kwargs...</code>: Additional parameters to override preset conditions in place.</li></ul><p><strong>Conditions Specification</strong></p><p>The <code>conditions</code> parameter can be:</p><ul><li><code>:pcr</code> (default) or <code>:std</code>: Use preset conditions;</li><li><code>MeltingConditions</code> object: Custom conditions (for more info see: <a href="#SeqFold.MeltingConditions"><code>MeltingConditions</code></a>);</li><li><code>NTuple{7, Float64}</code>: <code>(seq1_conc, seq2_conc, Na, K, Tris, Mg, dNTPs)</code>;</li><li><code>NamedTuple</code> with condition fields.</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; tm(&quot;GGGGGG&quot;)
15.5

julia&gt; tm(&quot;GGGGGG&quot;, conditions=:pcr)
15.5

julia&gt; tm(&quot;GGGGGG&quot;, Mg=10)
23.0

julia&gt; tm(&quot;GGGGGG&quot;, conditions=:std)
2.6

julia&gt; tm(&quot;GGGGGG&quot;, conditions=:std, Na=100)
5.1

julia&gt; tm(&quot;GGGGGG&quot;, conditions=MeltingConditions(150, 150, 20, 0, 0, 10, 0))
16.8

julia&gt; tm(&quot;ACCCCC&quot;, &quot;GGGGGG&quot;)
6.2</code></pre><p><strong>Implementation</strong></p><p>The calculation uses nearest-neighbor thermodynamic parameters from related literature (follow links below to see sources), accounting for initialization terms, nearest-neighbor pairs, and terminal mismatches when present.</p><p><strong>See also</strong></p><p><a href="#SeqFold.DNA_NN"><code>SeqFold.DNA_NN</code></a>, <a href="#SeqFold.DNA_INTERNAL_MM"><code>SeqFold.DNA_INTERNAL_MM</code></a>, <a href="#SeqFold.DNA_TERMINAL_MM"><code>SeqFold.DNA_TERMINAL_MM</code></a>, <a href="#SeqFold.MeltingConditions"><code>MeltingConditions</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/phlaster/SeqFold.jl/blob/836e9c81532845afd2cb9655d1d32339af973583/src/tm.jl#L1-L51">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SeqFold.tm_cache-Tuple{AbstractString, AbstractString}" href="#SeqFold.tm_cache-Tuple{AbstractString, AbstractString}"><code>SeqFold.tm_cache</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">tm_cache(seq1, seq2; conditions=:pcr, kwargs...) -&gt; Matrix{Float64}
tm_cache(seq; conditions=:pcr, kwargs...) -&gt; Matrix{Float64}</code></pre><p>Compute a matrix of melting temperatures for all possible subsequences of a DNA sequence pair.</p><p><strong>Arguments</strong></p><ul><li><code>seq1::AbstractString</code>: DNA sequence;</li><li><code>seq2::AbstractString</code>: Another DNA sequence, must be the same length as <code>seq1</code>;</li><li><code>seq::AbstractString</code>: Single DNA sequence to be matched with its exact complement;</li><li><code>conditions</code>: Buffer conditions specification (see <code>tm</code> docstrings);</li><li><code>kwargs...</code>: Additional parameters to override preset conditions in place.</li></ul><p><strong>Returns</strong></p><p>A <code>Matrix{Float64}</code> where element (<code>i</code>, <code>j</code>) contains the melting temperature (in °C) of the subsequence from position <code>i</code> to position <code>j</code>, inclusive. Elements where <code>j &lt; i</code> contain <code>Inf</code> as they represent invalid ranges, and single-nucleotide subsequences also have <code>Inf</code> as they don&#39;t have meaningful Tm values.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; SeqFold.tm_cache(&quot;ATCC&quot;)
4×4 Matrix{Float64}:
 Inf  -212.6   -95.3   -48.6
 Inf    Inf   -161.6   -82.7
 Inf    Inf     Inf   -135.5
 Inf    Inf     Inf     Inf

julia&gt; SeqFold.tm_cache(&quot;AAGC&quot;, &quot;TTCG&quot;)
4×4 Matrix{Float64}:
 Inf  -204.8   -94.6   -40.3
 Inf    Inf   -166.7   -72.9
 Inf    Inf     Inf   -116.7
 Inf    Inf     Inf     Inf

julia&gt; SeqFold.tm_cache(&quot;AAGC&quot;, &quot;TTCG&quot;; conditions=:std)
4×4 Matrix{Float64}:
 Inf  -213.1  -109.3   -55.6
 Inf    Inf   -177.9   -88.1
 Inf    Inf     Inf   -129.8
 Inf    Inf     Inf     Inf</code></pre><p><strong>Implementation</strong></p><p>The function uses dynamic programming to build a cache of Tm values for all subsequences. The algorithm has <code>O(n²)</code> time and space complexity, where <code>n</code> is the sequence length. This approach avoids redundant calculations when multiple Tm values for different subsequences are needed.</p><p><strong>See also</strong></p><p><a href="#SeqFold.tm-Tuple{AbstractString, AbstractString}"><code>tm</code></a>, <a href="#SeqFold.gc_cache-Tuple{AbstractString}"><code>SeqFold.gc_cache</code></a>, <a href="#SeqFold.DNA_NN"><code>SeqFold.DNA_NN</code></a>, <a href="#SeqFold.DNA_INTERNAL_MM"><code>SeqFold.DNA_INTERNAL_MM</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/phlaster/SeqFold.jl/blob/836e9c81532845afd2cb9655d1d32339af973583/src/tm.jl#L94-L143">source</a></section></article><ul><li><a href="#SeqFold.SeqFold"><code>SeqFold.SeqFold</code></a></li><li><a href="#SeqFold.DNA_BULGE_LOOPS"><code>SeqFold.DNA_BULGE_LOOPS</code></a></li><li><a href="#SeqFold.DNA_DE"><code>SeqFold.DNA_DE</code></a></li><li><a href="#SeqFold.DNA_HAIRPIN_LOOPS"><code>SeqFold.DNA_HAIRPIN_LOOPS</code></a></li><li><a href="#SeqFold.DNA_INTERNAL_LOOPS"><code>SeqFold.DNA_INTERNAL_LOOPS</code></a></li><li><a href="#SeqFold.DNA_INTERNAL_MM"><code>SeqFold.DNA_INTERNAL_MM</code></a></li><li><a href="#SeqFold.DNA_MULTIBRANCH"><code>SeqFold.DNA_MULTIBRANCH</code></a></li><li><a href="#SeqFold.DNA_NN"><code>SeqFold.DNA_NN</code></a></li><li><a href="#SeqFold.DNA_TERMINAL_MM"><code>SeqFold.DNA_TERMINAL_MM</code></a></li><li><a href="#SeqFold.DNA_TRI_TETRA_LOOPS"><code>SeqFold.DNA_TRI_TETRA_LOOPS</code></a></li><li><a href="#SeqFold.MeltingConditions"><code>SeqFold.MeltingConditions</code></a></li><li><a href="#SeqFold.Structure"><code>SeqFold.Structure</code></a></li><li><a href="#SeqFold._bulge-NTuple{7, Any}"><code>SeqFold._bulge</code></a></li><li><a href="#SeqFold._cache-Tuple{Any, Any}"><code>SeqFold._cache</code></a></li><li><a href="#SeqFold._d_g-Tuple{Any, Any, Any}"><code>SeqFold._d_g</code></a></li><li><a href="#SeqFold._hairpin-NTuple{5, Any}"><code>SeqFold._hairpin</code></a></li><li><a href="#SeqFold._internal_loop-NTuple{7, Any}"><code>SeqFold._internal_loop</code></a></li><li><a href="#SeqFold._j_s-NTuple{4, Any}"><code>SeqFold._j_s</code></a></li><li><a href="#SeqFold._min_struct-Tuple"><code>SeqFold._min_struct</code></a></li><li><a href="#SeqFold._multi_branch"><code>SeqFold._multi_branch</code></a></li><li><a href="#SeqFold._pair-NTuple{5, Any}"><code>SeqFold._pair</code></a></li><li><a href="#SeqFold._stack-NTuple{7, Any}"><code>SeqFold._stack</code></a></li><li><a href="#SeqFold._traceback-NTuple{4, Any}"><code>SeqFold._traceback</code></a></li><li><a href="#SeqFold._trackback_energy-Tuple{Any}"><code>SeqFold._trackback_energy</code></a></li><li><a href="#SeqFold._v!-NTuple{7, Any}"><code>SeqFold._v!</code></a></li><li><a href="#SeqFold._w!-NTuple{7, Any}"><code>SeqFold._w!</code></a></li><li><a href="#SeqFold.dg-Tuple{AbstractString}"><code>SeqFold.dg</code></a></li><li><a href="#SeqFold.dg_cache"><code>SeqFold.dg_cache</code></a></li><li><a href="#SeqFold.dot_bracket-Tuple{AbstractString, Vector{SeqFold.Structure}}"><code>SeqFold.dot_bracket</code></a></li><li><a href="#SeqFold.fold-Tuple{AbstractString}"><code>SeqFold.fold</code></a></li><li><a href="#SeqFold.gc_cache-Tuple{AbstractString}"><code>SeqFold.gc_cache</code></a></li><li><a href="#SeqFold.tm-Tuple{AbstractString, AbstractString}"><code>SeqFold.tm</code></a></li><li><a href="#SeqFold.tm_cache-Tuple{AbstractString, AbstractString}"><code>SeqFold.tm_cache</code></a></li></ul></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Thursday 4 September 2025 17:48">Thursday 4 September 2025</span>. Using Julia version 1.11.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
